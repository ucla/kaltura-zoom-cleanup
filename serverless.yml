service: kaltura-zoom

provider:
  name: aws
  region: us-west-2
  runtime: provided
  stage: prod
  memorySize: 256

  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - secretsmanager:GetSecretValue
        - secretsmanager:ListSecrets
      Resource: '*'

plugins:
  - ./vendor/bref/bref

functions:
  cleanup:
    handler: index.php
    description: AWS Lambda function to delete all Zoom recordings associated to the default user
    layers:
      - ${bref:layer.php-73}
    timeout: 30
    events:
      # Run every day at midnight PDT (07:00 UTC)
      - schedule: cron(0 7 * * ? *)

# Exclude files from deployment
package:
  exclude:
    - 'tests/**'
